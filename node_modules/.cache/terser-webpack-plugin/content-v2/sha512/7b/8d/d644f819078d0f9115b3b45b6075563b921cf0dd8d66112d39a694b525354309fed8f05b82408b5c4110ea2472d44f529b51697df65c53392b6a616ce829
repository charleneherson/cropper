{"map":{"version":3,"sources":["pagesModule/study-report/components/poster-canvas.js"],"names":["global","push","171c","module","exports","__webpack_require__","Object","defineProperty","value","default","_common","_default2","name","props","learningData","type","Array","qrcodeurl","String","userName","userPic","harvestData","data","timer","ctx","result","buidFail","rate","fontHeight","footerHeight","photoHeight","posterCardBg","posterFooterBg","harvestIcon","crownIcon","crownBg","companyIcon","studyReportBg","icon","circleImg","closeIcon","mounted","this","initPermission","wx","createCanvasContext","getSystemInfoSync","screenWidth","startDraw","methods","drawBackBg","toPx","px","_this2","downloadFile","then","tempFilePath","drawImage","windowWidth","drawHarvestIcon","drawLearnPage","_this3","dataNum","dataUnit","setTextAlign","i","length","setFontSize","setFillStyle","num","fillText","unit","moveTo","lineTo","strokeStyle","lineWidth","stroke","font","typeText","drawCompanyIcon","drawText","text","leftWidth","initHeight","canvasWidth","currentLine","textHeight","lastSubStrIndex","drawLineText","lineCount","measureText","width","substring","_this4","drawCrownBg","_this5","drawCrownIcon","_this6","drawAvatar","_this7","save","beginPath","arc","Math","PI","clip","restore","setStrokeStyle","setLineWidth","drawCircleImg","_this8","drawTitle","isDraw","_this9","keys","title","aims","lineNum","_this9$drawText","drawFootBg","_this10","drawFooterWxCode","_this11","draw","setTimeout","handleToImage","_this","canvasToTempFilePath","x","y","height","canvasId","quality","success","res","fail","Toast","url","Promise","resolve","reject","statusCode","getSetting","withSubscriptions","auth","authSetting","undefined","authorize","scope","savePhotoToGallery","$emit","showModal","content","confirm","openSetting","_this12","showLoading","setInterval","clearInterval","saveImageToPhotosAlbum","filePath","err","hideLoading","closePosterPage","7d53","9870","__webpack_exports__","r","_poster_canvas_vue_vue_type_template_id_7d00269a___WEBPACK_IMPORTED_MODULE_0__","_poster_canvas_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__","__WEBPACK_IMPORT_KEY__","key","d","_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__","component","a20a","_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_poster_canvas_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__","_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_poster_canvas_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default","n","c7f4","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_10_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_10_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_3_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_10_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_poster_canvas_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_10_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_10_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_3_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_10_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_poster_canvas_vue_vue_type_style_index_0_lang_less___WEBPACK_IMPORTED_MODULE_0___default","ffd7","render","_vm","_h","$createElement","_self","_c","staticRenderFns"],"mappings":"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"},"code":"(global[\"webpackJsonp\"]=global[\"webpackJsonp\"]||[]).push([[\"pagesModule/study-report/components/poster-canvas\"],{\"171c\":function(t,o,e){\"use strict\";Object.defineProperty(o,\"__esModule\",{value:!0}),o.default=void 0;var n=e(\"f20c\"),i={name:\"network-empty\",props:{learningData:{type:Array,default:[]},qrcodeurl:{type:String,default:function(){return\"\"}},userName:{type:String,default:function(){return\"\"}},userPic:{type:String,default:function(){return\"\"}},harvestData:{type:Object,default:function(){return{}}}},data:function(){return{timer:null,ctx:null,result:\"\",buidFail:!1,rate:\"\",fontHeight:0,footerHeight:0,photoHeight:0,posterCardBg:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/poster-card-bg.png\",posterFooterBg:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/poster-footer-bg.png\",harvestIcon:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/point-item-icon.png\",crownIcon:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/poster-crown-icon.png\",crownBg:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/poster-crown-bg.png\",companyIcon:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/logo111%402x.png\",studyReportBg:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/poster-bg.png\",icon:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/logo111%402x.png\",circleImg:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/poster-circle-img.png\",closeIcon:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/study-report/study-footer-close.png\"}},mounted:function(){this.initPermission(),this.ctx=wx.createCanvasContext(\"canvas\",this),this.rate=wx.getSystemInfoSync().screenWidth/375,this.startDraw()},methods:{startDraw:function(){this.drawBackBg()},toPx:function(t){return t*this.rate},drawBackBg:function(){var t=this;this.downloadFile(this.studyReportBg).then((function(o){t.ctx.drawImage(o,0,0,wx.getSystemInfoSync().windowWidth,t.toPx(667)),t.drawHarvestIcon(!1)}))},drawLearnPage:function(){var t=this;this.downloadFile(this.posterCardBg).then((function(o){var e,n;t.footerHeight=t.toPx(310)+t.fontHeight,t.photoHeight=t.footerHeight+t.toPx(110.5)+t.toPx(121),t.ctx.drawImage(o,t.toPx(11),t.toPx(95),wx.getSystemInfoSync().windowWidth-t.toPx(22),t.footerHeight),t.ctx.setTextAlign(\"center\");for(var i=0;i<t.learningData.length;i++)t.ctx.setFontSize(32),t.ctx.setFillStyle(\"#FF6A6A\"),t.learningData[i].num<10?(e=wx.getSystemInfoSync().windowWidth/2-t.toPx(105)+t.toPx(100*i),n=wx.getSystemInfoSync().windowWidth/2-t.toPx(90)+t.toPx(100*i)):t.learningData[i].num<100&&t.learningData[i].num>=10?(e=wx.getSystemInfoSync().windowWidth/2-t.toPx(104)+t.toPx(100*i),n=wx.getSystemInfoSync().windowWidth/2-t.toPx(80)+t.toPx(100*i)):(e=wx.getSystemInfoSync().windowWidth/2-t.toPx(110)+t.toPx(100*i),n=wx.getSystemInfoSync().windowWidth/2-t.toPx(80)+t.toPx(100*i)),t.ctx.fillText(t.learningData[i].num,e,t.toPx(245)),t.ctx.setFontSize(10),t.ctx.setFillStyle(\"#999999\"),t.ctx.fillText(t.learningData[i].unit,n,t.toPx(245)),t.ctx.setFontSize(14),t.ctx.setFillStyle(\"#666666\"),i!=t.learningData.length-1&&(t.ctx.moveTo(wx.getSystemInfoSync().windowWidth/2-t.toPx(50)+t.toPx(100*i),t.toPx(230)),t.ctx.lineTo(wx.getSystemInfoSync().windowWidth/2-t.toPx(50)+t.toPx(100*i),t.toPx(246)),t.ctx.strokeStyle=\"#EEEEEE\",t.ctx.lineWidth=t.toPx(1),t.ctx.stroke()),t.ctx.font=\"normal bold 14px sans-serif\",t.ctx.fillText(t.learningData[i].typeText,wx.getSystemInfoSync().windowWidth/2-t.toPx(100)+t.toPx(100*i),t.toPx(270)),t.ctx.font=\"normal 20px sans-serif\";t.fontHeight=0,t.drawCompanyIcon()}))},drawText:function(t,o,e,n,i){for(var a=0,s=0,r=0,c=\"\",l=0,x=0;x<t.length;x++)a+=this.ctx.measureText(t[x]).width,a>n?(i++,l++,i<4?c=t.substring(r,x):4==i&&(c=t.substring(r,x-3)+\"...\"),i<=4&&(this.ctx.fillText(c,o,e,n),e+=17.5*this.rate+6,a=0,r=x,s+=17.5*this.rate)):x==t.length-1&&i<4&&(this.ctx.fillText(t.substring(r,x+1),o,e,n),l++,i++,s+=17.5*this.rate);return{textHeight:s,lineCount:l}},drawCompanyIcon:function(){var t=this;this.downloadFile(this.companyIcon).then((function(o){t.ctx.drawImage(o,t.toPx(12),t.toPx(12),t.toPx(149),t.toPx(19)),t.drawCrownBg()}))},drawCrownBg:function(){var t=this;this.downloadFile(this.crownBg).then((function(o){t.ctx.drawImage(o,wx.getSystemInfoSync().windowWidth/2-t.toPx(104),t.toPx(80),t.toPx(204),t.toPx(38)),t.drawCrownIcon()}))},drawCrownIcon:function(){var t=this;this.downloadFile(this.crownIcon).then((function(o){t.ctx.drawImage(o,wx.getSystemInfoSync().windowWidth/2-t.toPx(30),t.toPx(43),t.toPx(48),t.toPx(38)),t.drawAvatar()}))},drawAvatar:function(){var t=this;this.downloadFile(this.userPic).then((function(o){t.ctx.save(),t.ctx.beginPath(),t.ctx.arc(wx.getSystemInfoSync().windowWidth/2,t.toPx(100),t.toPx(30),0,2*Math.PI),t.ctx.clip(),t.ctx.drawImage(o,wx.getSystemInfoSync().windowWidth/2-t.toPx(30),t.toPx(70),t.toPx(60),t.toPx(60)),t.ctx.restore(),t.ctx.arc(wx.getSystemInfoSync().windowWidth/2,t.toPx(100),t.toPx(32),0,2*Math.PI),t.ctx.setStrokeStyle(\"#FFFFFF\"),t.ctx.setLineWidth(t.toPx(2)),t.ctx.stroke(),t.drawCircleImg()}))},drawCircleImg:function(){var t=this;this.downloadFile(this.circleImg).then((function(o){t.ctx.drawImage(o,t.toPx(34),t.toPx(297),t.toPx(16),t.toPx(16)),t.drawTitle()}))},drawTitle:function(){this.ctx.font=\"normal bold 20px sans-serif\",this.ctx.setFillStyle(\"#333333\"),this.ctx.fillText(this.userName,wx.getSystemInfoSync().windowWidth/2,this.toPx(165)),this.ctx.font=\"normal 20px sans-serif\",this.ctx.setFontSize(16),this.ctx.setFillStyle(\"#666666\"),this.ctx.fillText(\"宝贝已经完成了今天的学习啦！\",wx.getSystemInfoSync().windowWidth/2,this.toPx(192)),this.drawHarvestIcon(!0)},drawHarvestIcon:function(t){var o=this;this.ctx.setTextAlign(\"left\"),this.downloadFile(this.harvestIcon).then((function(e){if(o.harvestData&&Object.keys(o.harvestData).length>0&&(o.ctx.setFontSize(18),o.ctx.setFillStyle(\"#333333\"),o.ctx.font=\"normal bold 18px sans-serif\",o.ctx.fillText(o.harvestData.title,o.toPx(42),o.toPx(320)),o.ctx.font=\"normal 20px sans-serif\",o.harvestData.aims&&Object.keys(o.harvestData.aims).length>0))for(var n=0,i=0;i<o.harvestData.aims.length;i++)if(n<=3){o.ctx.setFontSize(14),o.ctx.setFillStyle(\"#333333\"),o.ctx.drawImage(e,o.toPx(42),o.toPx(345)+1.5*o.fontHeight,o.toPx(10),o.toPx(9));var a=o.drawText(o.harvestData.aims[i],o.toPx(60),o.toPx(355)+1.5*o.fontHeight,o.toPx(266),n),s=a.lineCount,r=a.textHeight;n+=s,o.fontHeight+=r}t?o.drawFootBg():o.drawLearnPage()}))},drawFootBg:function(){var t=this;this.downloadFile(this.posterFooterBg).then((function(o){t.ctx.drawImage(o,t.toPx(11),t.toPx(96)+t.footerHeight,wx.getSystemInfoSync().windowWidth-t.toPx(22),t.toPx(128)),t.drawFooterWxCode()}))},drawFooterWxCode:function(){var t=this;this.downloadFile(this.qrcodeurl).then((function(o){t.ctx.drawImage(o,t.toPx(32),t.toPx(112)+t.footerHeight,t.toPx(89),t.toPx(89)),t.ctx.draw(!0,(function(){setTimeout((function(){t.handleToImage()}),300)}))}))},handleToImage:function(){var t=this;wx.canvasToTempFilePath({x:0,y:0,width:this.toPx(375),height:this.photoHeight,canvasId:\"canvas\",quality:1,success:function(o){t.result=o.tempFilePath},fail:function(o){t.buidFail=!0,(0,n.Toast)(\"加载失败，请重试\")}},this)},downloadFile:function(t){return new Promise((function(o,e){wx.downloadFile({url:t,success:function(t){200===t.statusCode?o(t.tempFilePath):e(t)}})}))},initPermission:function(){var t=this;wx.getSetting({withSubscriptions:!0,success:function(o){var e=o.authSetting[\"scope.writePhotosAlbum\"];void 0==e?wx.authorize({scope:\"scope.writePhotosAlbum\",success:function(){t.savePhotoToGallery()},fail:function(){t.$emit(\"permissionFail\")}}):!1===e?wx.showModal({title:\"提示\",content:\"去设置保存图片到相册权限\",success:function(o){o.confirm&&wx.openSetting({}),t.$emit(\"permissionFail\")},fail:function(){t.$emit(\"permissionFail\")}}):t.savePhotoToGallery()}})},savePhotoToGallery:function(){var t=this,o=this;wx.showLoading({title:\"正在生成中\"}),this.timer=setInterval((function(){t.result?(clearInterval(t.timer),t.timer=null,wx.saveImageToPhotosAlbum({filePath:t.result,success:function(t){o.$emit(\"getPosterImgUrl\",o.result,o.photoHeight)},fail:function(t){(0,n.Toast)(\"加载失败，请重试\"),wx.hideLoading(),o.$emit(\"permissionFail\")}})):t.buidFail&&(wx.hideLoading(),o.$emit(\"permissionFail\"))}),50)},closePosterPage:function(){this.$emit(\"closePosterPage\")}}};o.default=i},\"7d53\":function(t,o,e){},9870:function(t,o,e){\"use strict\";e.r(o);var n=e(\"ffd7\"),i=e(\"a20a\");for(var a in i)\"default\"!==a&&function(t){e.d(o,t,(function(){return i[t]}))}(a);e(\"c7f4\");var s=e(\"2877\"),r=Object(s[\"a\"])(i[\"default\"],n[\"a\"],n[\"b\"],!1,null,null,null);o[\"default\"]=r.exports},a20a:function(t,o,e){\"use strict\";e.r(o);var n=e(\"171c\"),i=e.n(n);for(var a in n)\"default\"!==a&&function(t){e.d(o,t,(function(){return n[t]}))}(a);o[\"default\"]=i.a},c7f4:function(t,o,e){\"use strict\";var n=e(\"7d53\"),i=e.n(n);i.a},ffd7:function(t,o,e){\"use strict\";var n=function(){var t=this,o=t.$createElement;t._self._c},i=[];e.d(o,\"a\",(function(){return n})),e.d(o,\"b\",(function(){return i}))}}]);","extractedComments":[]}