{"map":{"version":3,"sources":["pagesModule1/@yaya/director-uni/lib/yaya-scene-write/components/yaya-write-card.js"],"names":["global","push","36ca","module","exports","__webpack_require__","5bc8","uni","Object","defineProperty","value","default","_regenerator","_interopRequireDefault","_index","obj","__esModule","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","HanziWriterComp","e","bind","_default2","name","components","props","question","type","pageIndex","Number","currentPage","allStop","Boolean","isPause","computed","data","innerAudioContext","innerAudioContext1","timer","canSubmit","isShowGif","startTime","isPlay","penAnimeData","animeOption","duration","timingFunction","penStrokeArray","url","width","height","intervalWarnArray","curPenStroke","imageData","userStrokes","intervalWarnTimer","blockId","isWonderful","showCanvas","canvasImg","animeTimer","animeShow","isToStop","perPoint","perDrawPoint","allDuration","watch","val","initWriter","created","mounted","methods","getCanvasDom","_getCanvasDom","mark","_callee","ref","wrap","_context","prev","next","abrupt","createSelectorQuery","in","select","fields","node","size","exec","res","canvas","ctx","getContext","canvasInstance","stop","_x","_initWriter","_callee2","title","audio","animation","img","writer","_this","_context2","createAnimation","destroy","wx","createInnerAudioContext","src","play","onEnded","handleDelayFn","Math","abs","parseInt","$refs","hanziWriter","sent","createImage","character","charDataLoader","char","onload","onError","request","concat","encodeURIComponent","success","quizInterval","keepUserStrokeAfterSuccess","highlightOnComplete","highlightColor","showHintAfterMisses","leniency","checkSingleStroke","miniDistance","drawUserStrokeAction","points","length","forEach","point","drawImage","x","y","addPoint","retData","gapX","gapY","sqrt","pow","unshift","quiz","onComplete","$emit","canvasToTempFilePath","clearInterval","setTimeout","deletDelay","submit","tempFilePath","fail","onStartStroke","curStroke","characterStrokes","strokeNum","animeDelay","wrapperAxisPoints","onStartUserStroke","onCorrectStroke","drawnPath","nextStroke","handleStrokeFn","onMistake","hideCharacter","_x2","isCorrect","startDrawAnime","_this2","index","translate","step","opacity","export","writeImg","uploadFile","filePath","header","content-type","JSON","parse","userKv","standardAnswer","writingFile","submitObj","category","answerRecordSubmit","answerRecordObj","tidId","tid","tidType","answerData","tidData","isSign","correct","answer","Date","first","complete","_this3","floor","random","_this4","setInterval","clearTimeout","destroyed","call","938a","__webpack_exports__","r","_yaya_write_card_vue_vue_type_template_id_019400a1_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_yaya_write_card_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__","__WEBPACK_IMPORT_KEY__","d","_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__","component","a74e","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_yaya_write_card_vue_vue_type_style_index_0_id_019400a1_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_yaya_write_card_vue_vue_type_style_index_0_id_019400a1_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","e2fd","render","_vm","_h","$createElement","_self","_c","staticRenderFns","eb97","_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_yaya_write_card_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__","_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_yaya_write_card_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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"},"code":"(global[\"webpackJsonp\"]=global[\"webpackJsonp\"]||[]).push([[\"pagesModule1/@yaya/director-uni/lib/yaya-scene-write/components/yaya-write-card\"],{\"36ca\":function(t,e,n){},\"5bc8\":function(t,e,n){\"use strict\";(function(t){Object.defineProperty(e,\"__esModule\",{value:!0}),e.default=void 0;var i=r(n(\"a34a\")),a=r(n(\"bcfd\"));function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n,i,a,r,o){try{var s=t[r](o),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(i,a)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var r=t.apply(e,n);function s(t){o(r,i,a,s,u,\"next\",t)}function u(t){o(r,i,a,s,u,\"throw\",t)}s(void 0)}))}}var u=function(){return n.e(\"pagesModule1/@yaya/director-uni/lib/yaya-scene-write/components/hanziWrite/HanziWriter\").then(n.bind(null,\"c4a8\"))},c={name:\"yayaWriteCard\",components:{HanziWriterComp:u},props:{question:{type:Object,default:function(){}},pageIndex:{type:Number,default:0},currentPage:{type:Number,default:0},allStop:{type:Boolean,default:!1},isPause:{type:Boolean,default:!0}},computed:{},data:function(){return{innerAudioContext:null,innerAudioContext1:null,timer:null,canSubmit:!1,isShowGif:!1,startTime:0,isPlay:!1,penAnimeData:null,animeOption:{duration:300,timingFunction:\"linear\"},penStrokeArray:[{type:\"bamboo\",url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/bamboo_icon.png\",width:100,height:100},{type:\"fish\",url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/fish_icon.png\",width:100,height:100},{type:\"yinghua\",url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/yinghua_icon.png\",width:100,height:100}],intervalWarnArray:[{url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/write_warning_tone1.mp3\"},{url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/write_warning_tone2.mp3\"},{url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/write_warning_tone3.mp3\"},{url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/write_warning_tone4.mp3\"}],curPenStroke:{type:\"bamboo\",url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/bamboo_icon.png\",imageData:\"\",width:100,height:100},userStrokes:[],intervalWarnTimer:null,blockId:0,isWonderful:!0,showCanvas:!0,canvasImg:\"\",animeTimer:null,animeShow:!0,isToStop:!1,perPoint:null,perDrawPoint:null,allDuration:0}},watch:{currentPage:function(t){t!==this.pageIndex||this.isPause||this.initWriter(this.question)},allStop:function(t){t&&(this.isToStop=!0)},isPause:function(t){t||this.currentPage!==this.pageIndex||this.isToStop||this.initWriter(this.question)}},created:function(){},mounted:function(){},methods:{getCanvasDom:function(){var e=s(i.default.mark((function e(n){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",new Promise((function(e){t.createSelectorQuery().in(n).select(\"#writer-canvas\").fields({node:!0,size:!0}).exec((function(t){var n=t[0].node,i=n.getContext(\"2d\");e({ctx:i,canvasInstance:n})}))})));case 1:case\"end\":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),initWriter:function(){var e=s(i.default.mark((function e(n){var r,o,s,u,c,l,h=this;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=n.title,o=n.audio,s=t.createAnimation(this.animeOption),this.animation=s,this.innerAudioContext&&this.innerAudioContext.destroy(),this.innerAudioContext=wx.createInnerAudioContext(),this.innerAudioContext.src=o.url,this.innerAudioContext.play(),this.innerAudioContext.onEnded((function(){h.handleDelayFn()})),this.blockId=this.question&&this.question.blockId||0,this.curPenStroke=this.penStrokeArray[Math.abs(parseInt((this.blockId%10-1)/3))],e.next=13,this.getCanvasDom(this.$refs.hanziWriter);case 13:u=e.sent,this.$refs.hanziWriter.ctx=u.ctx,this.$refs.hanziWriter.canvasInstance=u.canvasInstance,c=u.canvasInstance.createImage(),c.src=this.curPenStroke.url,this.curPenStroke.imageData=c,l=new a.default(this.$refs.hanziWriter,{character:r,charDataLoader:function(e,n,i){t.request({url:\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/data/\".concat(encodeURIComponent(e),\".json\"),success:function(t){n(t.data)}})},quizInterval:1,keepUserStrokeAfterSuccess:!0,highlightOnComplete:!1,highlightColor:\"#3FC6FF\",showHintAfterMisses:1,leniency:1,checkSingleStroke:!0,miniDistance:8,drawUserStrokeAction:function(t,e){(1!==e.length||e[0])&&e.forEach((function(e){var n=h.curPenStroke.width,i=h.curPenStroke.height;t.drawImage(h.curPenStroke.imageData,e.x-n/2,e.y-i/2,n,i)}))},addPoint:function(t){h.perPoint||(h.perPoint=t);var e=[t],n=h.perPoint.x-t.x,i=h.perPoint.y-t.y;Math.sqrt(Math.pow(n,2)+Math.pow(i,2));return Math.abs(i)>16&&Math.abs(i)>16?n<0&&i<0||n>0&&i>0?e.unshift({x:h.perPoint.x-Math.abs(n)/2,y:h.perPoint.y-Math.abs(i)/2}):e.unshift({x:h.perPoint.x-Math.abs(n)/2,y:h.perPoint.y+Math.abs(i)/2}):(Math.abs(n)>16&&e.unshift({x:h.perPoint.x+Math.abs(n)/2,y:h.perPoint.y}),Math.abs(i)>16&&e.unshift({x:h.perPoint.x,y:h.perPoint.y+Math.abs(i)/2})),h.perPoint=t,e}}),this,l.quiz({onComplete:function(t){h.$emit(\"changeFlashStatus\",3),wx.canvasToTempFilePath({canvas:h.$refs.hanziWriter.canvasInstance,width:270,height:270,success:function(t){clearInterval(h.animeTimer),setTimeout((function(){h.deletDelay(),h.submit(t.tempFilePath)}),2e3)},fail:function(t){}})},onStartStroke:function(t){var e=t.characterStrokes[t.strokeNum];h.animeDelay(e.wrapperAxisPoints)},onStartUserStroke:function(t){h.animeShow=!1,clearInterval(h.animeTimer)},onCorrectStroke:function(t){h.userStrokes.push(t.drawnPath);var e=t.characterStrokes[t.strokeNum+1];e&&h.animeDelay(e.wrapperAxisPoints),h.perPoint=null,h.handleStrokeFn(!0)},onMistake:function(t){var e=t.characterStrokes[t.strokeNum];h.animeDelay(e.wrapperAxisPoints),h.perPoint=null,h.handleStrokeFn()}}),l.hideCharacter(),this.writer=l;case 24:case\"end\":return e.stop()}}),e,this)})));function n(t){return e.apply(this,arguments)}return n}(),handleStrokeFn:function(t){this.handleDelayFn(),this.$emit(\"changeFlashStatus\",t?1:2),this.innerAudioContext.src=\"https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-write/\".concat(t?\"right_sound\":\"wrong_tone\",\".mp3\"),this.innerAudioContext.play(),t||(this.isWonderful=t)},startDrawAnime:function(t){var e=this;t.forEach((function(t,n){e.animation.translate(t.x,t.y).step({duration:300}),0===n&&e.animation.opacity(1).step({duration:300})})),this.animation.opacity(0).step({duration:300}),this.penAnimeData=this.animation.export(),setTimeout((function(){e.penAnimeData=null}),this.animeOption.duration*(t.length+2))},submit:function(t){var e=this;wx.uploadFile({url:\"https://yuwen.zybang.com/kid-chinese/inclass/audioupload\",filePath:t,name:\"audioFile\",header:{\"content-type\":\"multipart/form-data\"},success:function(t){var n=JSON.parse(t.data),i={standardAnswer:e.question.title,writingFile:e.userStrokes},a={type:e.question.category,userKv:i},r={type:e.question.category},o={tidId:e.question.tid,tidType:e.question.category,isCorrect:1},s={},u={isSign:1,correct:1};u.answer=[n.data.url],u.duration=parseInt((+new Date-e.startTime)/1e3),u.userKv=[],s[e.question.tid]=u,a.answerData=s,a.first=e.isWonderful?1:0,o.answerData=s,r.answerData=o,e.$emit(\"nextQuestion\",a,e.isWonderful),e.$emit(\"answerRecord\",r)},fail:function(t){},complete:function(t){}})},handleDelayFn:function(){var t=this;this.deletDelay(),this.intervalWarnTimer=setTimeout((function(){t.innerAudioContext1=wx.createInnerAudioContext(),t.innerAudioContext1.src=t.intervalWarnArray[Math.floor(4*Math.random())].url,t.innerAudioContext1.play()}),3e3)},animeDelay:function(t){var e=this;this.animeShow=!0,clearInterval(this.animeTimer),this.animeTimer=null,this.penAnimeData=null,setTimeout((function(){e.startDrawAnime(t)}),0),this.animeTimer=setInterval((function(){e.startDrawAnime(t)}),this.animeOption.duration*(t.length+4))},deletDelay:function(){clearTimeout(this.intervalWarnTimer),this.intervalWarnTimer=null,this.innerAudioContext1=null}},destroyed:function(){this.innerAudioContext=null,this.innerAudioContext1=null}};e.default=c}).call(this,n(\"543d\")[\"default\"])},\"938a\":function(t,e,n){\"use strict\";n.r(e);var i=n(\"e2fd\"),a=n(\"eb97\");for(var r in a)\"default\"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n(\"a74e\");var o=n(\"2877\"),s=Object(o[\"a\"])(a[\"default\"],i[\"a\"],i[\"b\"],!1,null,\"019400a1\",null);e[\"default\"]=s.exports},a74e:function(t,e,n){\"use strict\";var i=n(\"36ca\"),a=n.n(i);a.a},e2fd:function(t,e,n){\"use strict\";var i=function(){var t=this,e=t.$createElement;t._self._c},a=[];n.d(e,\"a\",(function(){return i})),n.d(e,\"b\",(function(){return a}))},eb97:function(t,e,n){\"use strict\";n.r(e);var i=n(\"5bc8\"),a=n.n(i);for(var r in i)\"default\"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);e[\"default\"]=a.a}}]);","extractedComments":[]}