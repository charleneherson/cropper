var HybridSdkCommon=function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;for(var r=Object.freeze({__proto__:null,get core_openWindow(){return q},get openWindow(){return q},get windowConfig(){return Y},get openBrowser(){return z},get core_goBack(){return V},get goBack(){return V},get share(){return Q},get core_share(){return Q},get core_login(){return G},get login(){return G},get checkLogin(){return X},get nativeLog(){return ee},get fetchImg(){return te},get dial(){return re},get downloader(){return oe},get copyText(){return ie},get imgBrowser(){return ce},get core_audio(){return ue},get audio(){return ue},get core_showDialog(){return le},get showDialog(){return le},get netType(){return de},get core_request(){return pe},get request(){return fe},get core_getCommonParameters(){return he},get getCommonParameters(){return he},get isAppInstalled(){return me},get removeNativeLoading(){return ve},get commonPay(){return ye},get hybrid(){return _e},get pageTo(){return Be},get RouteSwitcher(){return we},get core_openUrl(){return Te},get setStorage(){return Ce},get getStorage(){return je},get showDebuger(){return De}}),n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o={},a=["String","Number","Array","Function"],i=0,c=a.length
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */;i<c;i++){!function(e){o["is"+e]=function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}}(a[i])}function s(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?decodeURIComponent(r[2]):null}function u(e){return function(t){return e&&e(t),Promise.resolve(t)}}function l(e){return function(t){return e&&e(t),Promise.reject(t)}}function d(e,t){return function(r){void 0===r&&(r={}),200==r.code?r.data&&!1===r.data.callResult?t&&t(r.data):r.data?e&&e(r.data):e&&e(r):200==r.errcode?(r.data&&e&&e(r.data),!r.data&&e&&e(r)):404==r.code||404==r.errcode?(r.data&&t&&t(r.data),!r.data&&t&&t(r)):e&&e(r)}}function g(e,t){return function(e,t,r){return new Promise((function(n,o){var a=function(e){n(e)},i=function(e){o(e)};r&&e(t,r,d(a,i)),!r&&e(t,d(a,i))}))}(U,e,t)}var p=function(e){if(null===e)return null;var t=Object.assign({},e);return Object.keys(t).forEach((function(r){return t[r]="object"==typeof e[r]?p(e[r]):e[r]})),Array.isArray(e)&&e.length?(t.length=e.length)&&Array.from(t):Array.isArray(e)?Array.from(e):t},f=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var o=r[n].trim();if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null},h={getQueryString:s,isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},queryString:function(e){return e?function(e){for(var t=[],r=0,n=e.length;r<n;r++)e[r]&&t.push(e[r]);return t}(Object.keys(e).map((function(t){return void 0===e[t]?"":encodeURIComponent(t)+"="+encodeURIComponent(e[t])}))).join("&"):""},trim:function(e){return e.replace(/^\s+|\s+$/gm,"")},guid:function(){return"xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},getMergedCallback:d,deepClone:p,getCookie:f},m={core_goBack:210,goBack:210,openBrowser:210,windowConfig:210,core_openWindow:210,openWindow:210,core_share:210,share:210,checkLogin:210,core_login:210,login:210,nativeLog:210,fetchImg:210,dial:210,downloader:210,copyText:210,imgBrowser:210,core_audio:210,audio:210,core_showDialog:210,showDialog:210,netType:210,core_request:210,request:210,core_getCommonParameters:210,getCommonParameters:210,isAppInstalled:210,removeNativeLoading:210,pageTo:210,hybrid:210,commonPay:210,setStorage:210,getStorage:210,onPageEnter:210,onPageLeave:210,onPageDestroy:210,onPagePullFresh:210,onNativeCallback:210},v=navigator.userAgent.toLowerCase(),y={android:v.indexOf("android")>-1||v.indexOf("adr")>-1,iPhone:v.indexOf("iphone")>-1,iPad:v.indexOf("ipad")>-1},_=(y.android||y.iPhone||y.iPad)&&v.indexOf("_vc")>0,b=_?"airclass":"a_irclass",w=_?"homework":"h_omework",k=v.indexOf(b)>-1?b:v.indexOf(w)>-1?w:"unknow";function B(e){return e.replace(/^\s+|\s+$/gm,"")}P=k+"_vc/",x=new RegExp(P+"[\\d.]+\\s*","ig"),A=v.match(x),Array.isArray(A)&&B(A[0].replace(P,"")),T=k+"_vcname/",C=new RegExp(T+"[\\d.]+\\s*","ig"),j=v.match(C),Array.isArray(j)&&B(j[0].replace(T,""));var P,x,A,T,C,j,D=_,S={isAndroid:function(){return y.android},isIPhone:function(){return y.iPhone},isIPad:function(){return y.iPad}},O=function(){var e={},t=window.navigator.userAgent.split(" ");if((t=t.filter((function(e){return e.indexOf("jsBridge_isNewJsBridge/")>=0||e.indexOf("jsBridge_vc/")>=0||e.indexOf("jsBridge_os_version/")>=0}))).forEach((function(t){var r=t.split("/");e[r[0]]=r[1]})),e.jsBridge_vc){var r=e.jsBridge_vc;r=+r.split(".").join(""),e.jsBridge_vcnum=r}return"1"===e.jsBridge_isNewJsBridge&&(e.isNewJsBridge=!0),e}();var L=window,E=/(localhost|127.0.0.1)/.test(location.origin),N=null;function R(){var e=E?"/hybridaction/":"iknowhybrid://",t=0;return function(r,n,a){var i=function(){var e=document.createElement("iframe");return e.setAttribute("style","display:none;"),e.setAttribute("height","0px"),e.setAttribute("width","0px"),e.setAttribute("frameborder","0"),document.documentElement.appendChild(e),e}();n&&"[object Function]"===Object.prototype.toString.call(n)&&(a=n,n={});var c=function(r,n,a){var i=e+r+"?",c=h.guid();if(i+="data="+encodeURIComponent(JSON.stringify(n||{})),a){var s="__cb__"+r+"__"+c+"__"+t++;E&&(N=s),L[s]=function(){var e=arguments;(e=[].slice.call(e)).push(s),a&&a.apply(window,e),o.isFunction(a.remove)?s&&a.remove.apply(a,[s]):delete L[s]},i+="&__callback__="+s}return i}(r,n,a);E&&(i.onload=window[N]),N=null,i.setAttribute("src",c),function(e){e.timer=setTimeout((function(){e.parentNode.removeChild(e),clearTimeout(e.timer)}),3e3)}(i)}}L.hybrid_sdk_framekey=(new Date).getTime()+h.guid(),e.iframeHybrid=D?R():"unknow"===k?function(){}:function(e,t,r){t&&"[object Function]"===Object.prototype.toString.call(t)&&(r=t,t={}),(t=t||{}).hybrid_sdk_framekey=L.hybrid_sdk_framekey,L.parent.h5PluginAction(e,t,r)},E&&(console.log("本地环境，createHybrid"),e.iframeHybrid=R());var W=/(localhost|127.0.0.1)/.test(window.location.origin),F=window;function I(t,r,n){e.iframeHybrid(t,r,(function(e){n({code:200,data:e})}))}function U(e,t,r){var n=O.jsBridge_os_version;n=n?n.substr(0,3):10,S.isAndroid()&&+n<4.2?I(e,t,r):(t&&"[object Function]"===Object.prototype.toString.call(t)&&(r=t,t={}),r&&(F[e]=r),F.__jsBridge.invoke(e,t,r))}F.__jsBridge={callbackPool:{},ack_no:1},F.__jsBridge.invoke=function(e,t,r){t?"[object Function]"===Object.prototype.toString.call(t)&&(r=t,t={}):t={};var n={action:e,param:t};if(r){if(W){var o=arguments;return o=[].slice.call(o),void r.apply(window,o)}var a="cbk_"+F.__jsBridge.ack_no++;n.callbackKey=a,F.__jsBridge.callbackPool[a]=r,"core_windowConfig"==e&&(F.__jsBridge.callbackPool[e]=r)}var i=F.__jsBridge.param(n);F.ZYBJSBridge?F.ZYBJSBridge.postMessage(i):F.webkit&&F.webkit.messageHandlers&&F.webkit.messageHandlers.ZYBJSBridge?F.webkit.messageHandlers.ZYBJSBridge.postMessage(i):I(e,t,r)},F.__jsBridge.callback=function(e){var t=e.callbackKey,r=F.__jsBridge.callbackPool[t];"function"==typeof r?(delete e.callbackKey,e.errcode&&(e.code=e.errcode,delete e.errcode),r(e),r.remove&&"function"==typeof r.remove?(r.delete&&"function"==typeof r.delete||(r.delete=function(e){delete F.__jsBridge.callbackPool[e]}),r.remove.apply(r,[t])):delete F.__jsBridge.callbackPool[t]):console.error("没有找到callbackKey")},F.__jsBridge.param=function(e){var t=JSON.stringify(e);return t||""};var H=window,J=H.getOpenWindowClassName&&H.getOpenWindowClassName()||null,M={pageUrl:"",title:"",swapBack:0,hideStatusBar:0,hideNavBar:0,screenDirection:0,navBarBgColor:"",staBarStyle:0,showShareBtn:0,allLight:0},Z=["","WebViewController","com.baidu.homework.activity.web.ZybWebActivity","ZYBWKWebViewController","com.baidu.homework.activity.live.web.LiveCacheHybridActivity"];function q(e){if(e.businessData){var t=e.businessData.classType;t.ios&&(e.businessData.className_ios=Z[t.ios]),t.android&&(e.businessData.className_android=Z[t.android]),delete e.businessData.classType,e.businessData=n(n({},J),e.businessData)}else e.businessData=J;return g("core_openWindow",n(n({},M),e))}var K={pageUrl:"",title:"",swapBack:0,hideStatusBar:0,hideNavBar:0,screenDirection:0,navBarBgColor:"",staBarStyle:0,allLight:0,showShareBtn:0,shareBtnBgImg:"",shareData:{},shareCallBack:function(){},backShowDialog:0,dialogData:{},dialogCallback:function(){g("core_exit",{backWindow:1})}};function Y(e){var t=n({},e);return new Promise((function(e,r){var n=function(t){e(t)},o=function(e){r(e)};U("core_windowConfig",t,(function(e){var r=d(n,o),a=t.shareCallBack||K.shareCallBack,i=t.dialogCallback||K.dialogCallback;e.data&&e.data.result+1>0?a(e.data):e.data&&e.data.res?i(e.data):r(e.data)}))}))}function z(e){U("core_openBrowser",e)}function V(e){return g("core_exit",n({backWindow:0},e))}var $={style:0,title:"",content:"",contentWeibo:"",url:"",imgBase64:"",imgUrl:"",origin:"",fileExtension:"",shotScreen:0,channelArray:[0,1,2,3,4],directChannel:-1};function Q(e,t){var r=n(n({},$),e),o=u(t),a=l(t);return g("core_share",r).then(o,a)}function G(e,t){var r=u(t),n=l(t);return g("core_login",e).then(r,n)}function X(e){var t=u(e),r=l(e);return g("core_isLogin").then(t,r)}function ee(e){return g("core_nlog",n({},e))}function te(e,t){var r=n({},e),o=u(t),a=l(t);return g("core_fetchImg",r).then(o,a)}function re(e){return g("core_dial",e)}var ne={url:"",type:0};function oe(e,t){var r=n(n({},ne),e),o=u(t),a=l(t);return g("core_downloader",r).then(o,a)}var ae={content:"",hint:""};function ie(e){return g("core_copyToClipboard",n(n({},ae),e))}function ce(e){return g("core_showImgBrowser",n({},e))}var se={playStatus:1,url:"",loop:0,interrupt:1};function ue(e){var t=e.data,r=e.success,o=e.error,a=e.complete,i=e.notFound,c=e.interrupt,s=n(n({},se),t);s.srcName&&(s.url=s.srcName,delete s.srcName),U("core_audioDisplay",s,(function(e){switch(+e.data.code){case 200:r&&r(e.data);break;case 202:a&&a(e.data);break;case 403:c&&c(e.data);break;case 500:o&&o(e.data);break;default:o(e.data)}404==e.code&&i&&i(e.data)}))}function le(e,t){var r=n({title:""},e),o=u(t),a=l(t);return g("core_showDialog",r).then(o,a)}function de(e){var t=u(e),r=l(e);return g("core_netStatus").then(t,r)}var ge={type:"post",url:"",params:{}};function pe(e){return g("core_httpRequest",n(n({},ge),e))}function fe(e,r){var o=u(r),a=l(r);return D?pe(e).then(o,a):function(e){return t({method:e.type,url:e.url,headers:e.headers,data:e.params})}(e).then((function(e){var t=n({env:"web",errorTips:""},e);return o&&o(t),t}))}function he(e){var t=u(e),r=l(e);return g("core_commonData").then(t,r)}function me(e,t){var r={url:e.url},n=u(t),o=l(t);return g("core_isAppInstalled",r).then(n,o)}function ve(){return g("core_removeLoading")}function ye(e,t){var r=u(t),n=l(t);return O.jsBridge_vcnum>=210?g("core_FIRE",e).then(r,n):Promise.reject({code:404,errcode:404}).then(r,n)}function _e(t,r,n){0===t.indexOf("core_")?U(t,r,n):e.iframeHybrid(t,r,n)}D&&O.isNewJsBridge&&setTimeout((function(){ve()}),3e3);var be=210,we=function(){function e(t){if(this.isCommonActionReturned=!1,this.isRouteConfigReturned=!1,this.routeMap=null,this.initTimestamp=(new Date).getTime(),console.log("初始化RouteSwitcher时间"+this.initTimestamp),this.sdk=t||r,e.instance)return e.instance;console.log("switchConfig",O),this.isParsingUrlByOwn=O.jsBridge_vcnum<be}return e.prototype.pollingRoutesConfig=function(e){var t=this;if(e){this.storeRoutesMap(e);setInterval((function(){t.storeRoutesMap(e)}),6e4)}else console.log("configUrl 为空，不能请求路由表")},e.prototype.pageTo=function(e,t){if(console.log("pageTo this"),console.log(this),this.isParsingUrlByOwn){var r=this.parsingRoute(e),o=p(e);delete o.module,delete o.page,delete o.params,delete o.prefix;var a=n({pageUrl:r},o);console.log("sdk.core_openWindow({pageUrl:parsedUrl, ...otherParams})"),console.log(a);var i=u(t),c=l(t);return this.sdk.core_openWindow(a).then(i,c)}e.pageKey="zyb://"+e.module+"/page/"+e.page+e.params,delete e.module,delete e.page,delete e.params,console.log("sdk.core_openUrl(to, callback)"),console.log(e);i=u(t);var s=l(t);return this.sdk.core_openUrl(e).then(i,s)},e.prototype.parsingRoute=function(e){var t=e.module,r=e.page,n=e.params;return""+(e.prefix||"/static/hy/")+t+"/"+r+".html"+n},e.prototype.storeRoutesMap=function(e){var r=this;t.get(e).then((function(e){var t=e.data,n=void 0===t?{}:t,o=e.status;if((o+"").startsWith("4")||(o+"").startsWith("5"))throw new Error("get sparta route failed with status: "+o+", data: "+JSON.stringify(n)+" ");r.routeMap=n,r.isRouteConfigReturned=!0,console.log("获取路由表成功时间差"+((new Date).getTime()-r.initTimestamp))}))},e.prototype.getStoredRoutes=function(){return this.routeMap},e.prototype.getRouteConfUrl=function(){var e,t=this.platform,r=(new Date).getTime(),n=Math.floor(r/1e5),o=this.detectEnv();if(console.log("envType"),console.log(o),"online"===o.type)e="https://xxx.bsc.com/route/online/";else if("tips"===o.type)e=" https://xxx.bsc.com/route/tips/";else{if("docker"!==o.type)return null;e="https://xxx.bcs.com/route/"+o.name+"/"}return""+e+t+".json?t="+n},e.prototype.detectEnv=function(){var e=window.document.location.host,t=/(.*)-docker.*/g.exec(e);return"www.zybang.com"===e?null!==f("__tips__")||null!==s("__tips__")?{type:"tips"}:{type:"online"}:t?{type:"docker",name:t[1]}:{type:"unknow"}},e.instance=null,e}(),ke=new we;window.__router__=ke;var Be=ke.pageTo.bind(ke);window.__router__.pageTo.bind(window.__router__);var Pe=["","WebViewController","com.baidu.homework.activity.web.ZybWebActivity","ZYBWKWebViewController","com.baidu.homework.activity.live.web.LiveCacheHybridActivity"],xe=window,Ae=xe.getOpenWindowClassName&&xe.getOpenWindowClassName()||null;function Te(e){if(e.businessData){var t=e.businessData.classType;t.ios&&(e.businessData.className_ios=Pe[t.ios]),t.android&&(e.businessData.className_android=Pe[t.android]),delete e.businessData.classType,e.businessData=n(n({},Ae),e.businessData)}else e.businessData=Ae;return g("core_openUrl",n({},e))}function Ce(e,t){var r=u(t),n=l(t);return g("core_storage",e).then(r,n)}function je(e,t){var r=u(t),n=l(t);return g("core_getStorage",e).then(r,n)}function De(){return g("core_showDebuger")}var Se=window;function Oe(e,t){console.log("listen:"+e),Se.callbackList[e]||(Se.callbackList[e]=[]),Se.callbackList[e].push(t),console.log(Se.callbackList)}function Le(e,t){console.log(Se.callbackList);var r=Array.prototype.shift.call(arguments),n=Se.callbackList[r];if(console.log("trigger:"+r),console.log(n),!n||0===n.length)return!1;for(var o,a=0;o=n[a++];)o.apply(this,arguments)}function Ee(e,t){console.log("remove:"+e);var r=Se.callbackList[e];if(!r)return!1;if(t)for(var n=r.length-1;n>=0;n--){r[n]===t&&r.splice(n,1)}else;}Se.callbackList=Se.callbackList?Se.callbackList:{};var Ne,Re=window,We=function(){};return Re.extroActionTypePool=Re.extroActionTypePool?Re.extroActionTypePool:[],(Ne=e.ActionType||(e.ActionType={})).PageEnter="onPageActive",Ne.PageLeave="onPagePause",Ne.PageDestroy="onPageDestroy",Ne.AppEnterBackground="onEnterBackground",Ne.AppEnterForeground="onEnterForeground",Ne.PagePullFresh="pullRefresh",Re.NATIVE_CALLBACK=function(t){var r=Re.extroActionTypePool.length;if(0!==r)for(var n=0;n<r;n++)if(t.action_type===Re.extroActionTypePool[n])return void Le(t.action_type,t.data);switch(t.action_type){case e.ActionType.PageEnter:Le(e.ActionType.PageEnter,t.data);break;case e.ActionType.PageLeave:Le(e.ActionType.PageLeave,t.data);break;case e.ActionType.PageDestroy:Le(e.ActionType.PageDestroy,t.data);break;case e.ActionType.AppEnterBackground:Le(e.ActionType.AppEnterBackground,t.data);break;case e.ActionType.AppEnterForeground:Le(e.ActionType.AppEnterForeground,t.data);break;case e.ActionType.PagePullFresh:Le(e.ActionType.PagePullFresh,t.data);break;default:console.log("未知类型的全局回调, "+t.action_type)}},e.audio=ue,e.canUseCommon=function(e){var t=window,r=+O.jsBridge_isNewJsBridge,n=O.jsBridge_vcnum,o=t.webkit&&t.webkit.messageHandlers&&t.webkit.messageHandlers.ZYBJSBridge,a=1===r&&n>=210&&o;if(S.isAndroid()){var i=O.jsBridge_os_version;(i=i?+i.substr(0,3):10)<4.2&&(a=!1)}return a&&e&&"string"==typeof e&&(a=m[e]>=n),a},e.checkLogin=X,e.commonPay=ye,e.copyText=ie,e.core_audio=ue,e.core_getCommonParameters=he,e.core_goBack=V,e.core_login=G,e.core_openWindow=q,e.core_request=pe,e.core_share=Q,e.core_showDialog=le,e.dial=re,e.downloader=oe,e.fetchImg=te,e.getCommonParameters=he,e.getStorage=je,e.goBack=V,e.hybrid=_e,e.imgBrowser=ce,e.isAppInstalled=me,e.jsBridgeInfo=O,e.login=G,e.nativeLog=ee,e.netType=de,e.onNativeCallback=function(e,t){return void 0===t&&(t=We),Oe(e,t),Re.extroActionTypePool.push(e),{remove:function(){Ee(e,t)}}},e.onPageDestroy=function(t){return void 0===t&&(t=We),Oe(e.ActionType.PageDestroy,t),{remove:function(){Ee(e.ActionType.PageDestroy,t)}}},e.onPageEnter=function(t){return void 0===t&&(t=We),Oe(e.ActionType.PageEnter,t),{remove:function(){Ee(e.ActionType.PageEnter,t)}}},e.onPageLeave=function(t){return void 0===t&&(t=We),Oe(e.ActionType.PageLeave,t),{remove:function(){Ee(e.ActionType.PageLeave,t)}}},e.onPagePullFresh=function(t){return void 0===t&&(t=We),Oe(e.ActionType.PagePullFresh,t),{remove:function(){Ee(e.ActionType.PagePullFresh,t)},pullRefreshFinish:function(){U("pullRefreshFinish")}}},e.openBrowser=z,e.openWindow=q,e.pageTo=Be,e.postMessageHybrid=U,e.removeNativeLoading=ve,e.request=fe,e.setStorage=Ce,e.share=Q,e.showDialog=le,e.transformCacheUrl=function(e){return"1"===function(e){for(var t=window.location.search.substring(1).split("&"),r=0;r<t.length;r++){var n=t[r].split("=");if(n[0]===e)return n[1]}return!1}("zybhost")?function(e){if("string"!=typeof e)throw new Error("url must be string");return"zybhost://"+e.match(/^(.*\/\/)?(.*)$/)[2]}(e):e},e.windowConfig=Y,e}({},axios);
