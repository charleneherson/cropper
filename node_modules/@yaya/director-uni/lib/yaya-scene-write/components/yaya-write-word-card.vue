<template>
  <view class="yaya-write-word-card-container" id="yaya-write-word-card">
    <view class="word-gather" v-if="!firstGather">
      <view class="show-card container-part">
        <view class="card-star">
          <view class="word-gather-card">
            <view class="crad">
              {{ write }}
            </view>
            <view class="crad-right">
              <img
                src="https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/bg-rihght.png"
                alt=""
              />
            </view>
          </view>
        </view>
      </view>
      <view class="show-box container-part">
        <view class="box"> </view>
        <view class="box-cover"> </view>
      </view>
    </view>
    <view class="first-gather" v-if="firstGather">
      <view class="gather-yaya">
        <view class="bg-image"> </view>
        <!-- <img
          src="https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/yaya-guid.gif"
          alt=""
        /> -->
      </view>
      <view class="gather-guide">
        <view class="guide-bar">
          <img
            src="https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/word-bar.svg"
            alt=""
          />
        </view>
      </view>
    </view>
  </view>
</template>
<script>
export default {
  name: "yayaWriteWordCard",
  components: {},
  props: {
    write: {
      type: String,
      default: "",
    },
  },
  computed: {},
  data() {
    return {
      firstTmier: null,
      firstGather: false,
      isFirstGather: false,
      innerAudioContext: null,
      innerAudioContextFirst: null,
    };
  },
  created() {
    if (!wx.getStorageSync("fisrtGatherWord")) {
      this.isFirstGather = true;
      wx.setStorageSync("fisrtGatherWord", true);
    }
  },
  mounted() {
    console.log(
      "mountedmountedmountedmountedmountedmountedmountedmountedmountedmountedmountedmounted"
    );
    this.innerAudioContext = wx.createInnerAudioContext();
    this.innerAudioContext.src =
      "https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/core-gather.mp3";
    this.innerAudioContext.play();
    if (this.isFirstGather) {
      this.firstTmier = setTimeout(() => {
        this.firstGather = true;
        this.innerAudioContextFirst = wx.createInnerAudioContext();
        this.innerAudioContextFirst.src =
          "https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/first-gather.mp3";
        this.innerAudioContextFirst.play();
        setTimeout(() => {
          this.gatherFinish();
        }, 3500);
      }, 3500);
    } else {
      setTimeout(() => {
        this.gatherFinish();
      }, 3500);
    }
  },
  methods: {
    gatherFinish() {
      this.$emit("gatherFinish", this.write);
    },
  },
  destroyed() {
    clearTimeout(this.firstTmier);
    this.firstTmier = null;
  },
};
</script>
<style lang="scss" scoped>
@import "../../static/css/yaya-mixin.scss";
.yaya-write-word-card-container {
  background: rgba(0, 0, 0, 0.5);
  width: 100vw;
  height: 100vh;
  position: fixed;
  left: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  flex-direction: column;
  z-index: 100;
  .word-gather {
    position: relative;
    width: 100vw;
    height: 100vh;
    .word-gather-card {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container-part {
      .box-cover {
        width: tovmin(421);
        height: tovmin(338);
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        background-image: url("https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/box-half.png");
        background-size: cover;
        visibility: hidden;
        animation: show-cover 0.2s linear 1;
        animation-delay: 1.8s;
        //   animation-fill-mode: forwards;
        z-index: 120;
      }
      .card-star {
        position: absolute;
        top: tovmin(100);
        left: 50%;
        transform: translateX(-50%);
        margin-bottom: tovmin(-40);
        display: flex;
        justify-content: center;
        align-items: center;
        background-image: url("https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/star.png");
        background-size: tovmin(1983) tovmin(4320);
        width: tovmin(661);
        height: tovmin(480);
        animation: card-star 0.9s steps(1) 1;
        z-index: 100;
      }
      .crad {
        height: tovmin(266);
        width: tovmin(212);
        background-image: url("https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/bg-core.png");
        background-size: cover;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: tovmin(120);
        font-family: KaiTiFont;
        animation: card-animation 1.95s linear 1;
        animation-fill-mode: forwards;
        z-index: 110;
      }
      .crad-right {
        position: absolute;
        height: tovmin(538);
        width: tovmin(538);
        animation: right-animation 1.95s linear 1;
        animation-fill-mode: forwards;
        z-index: 100;
        img {
          width: 100%;
          height: 100%;
          animation: right-rotate 9s linear infinite;
        }
      }
      .box {
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        background-image: url("https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/treasure-box-1.png");
        background-size: tovmin(1684) tovmin(5746);
        width: tovmin(421);
        height: tovmin(338);
        animation: box-move 2.2s steps(1) 1;
        animation-delay: 0.9s;
      }
    }
  }
  .first-gather {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    width: 100%;
    height: 100%;
    .gather-yaya {
      animation: gather-yaya-animation 0.6s linear 1;
      animation-fill-mode: forwards;
      margin-right: tovmin(83);
      margin-bottom: tovmin(34);
      .bg-image {
        background-image: url("https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/yaya-guide.png");
        background-size: tovmin(1960) tovmin(1080);
        width: tovmin(280);
        height: tovmin(360);
        animation: gather-yaya-flag 1s steps(1) infinite;
        animation-delay: 0.5s;
      }
    }
    .gather-guide {
      width: tovmin(445);
      height: tovmin(666);
      position: relative;
      margin-left: tovmin(100);
      animation: gather-guide-animation 0.6s linear 1;
      animation-fill-mode: forwards;
      background-image: url("https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/sdk-media/yaya-word-card/word-page.svg");
      background-size: cover;
      .guide-bar {
        width: tovmin(558);
        height: tovmin(160);
        position: absolute;
        top: tovmin(405);
        left: tovmin(-44);
        visibility: hidden;
        animation: gather-bar-animation 0.3s cubic-bezier(0.33, 0, 0, 1) 1;
        animation-delay: 0.5s;
        animation-fill-mode: forwards;
        img {
          width: 100%;
          height: 100%;
        }
      }
    }
  }
}
@keyframes card-animation {
  0% {
    visibility: visible;
    transform: scale(0.1, 0.1);
  }
  10% {
    transform: scale(1, 1);
  }
  45% {
    transform: scale(1.3, 1.3);
  }
  60% {
    transform: scale(1, 1) translateY(-20%);
  }
  89% {
    transform: scale(1, 1) translateY(-10%);
  }
  99% {
    transform: scale(0.3, 0.3) translateY(320%);
    visibility: hidden;
  }
  100% {
    visibility: hidden;
    // transform: scale(0, 0) translateY(850%);
  }
}
@keyframes right-animation {
  0% {
    visibility: visible;
    transform: scale(0.1, 0.1);
  }
  45% {
    transform: scale(1.3, 1.3);
  }
  60% {
    transform: scale(1, 1) translateY(-15%);
  }
  89% {
    transform: scale(1, 1) translateY(-10%);
    visibility: hidden;
  }
  99% {
    visibility: hidden;
  }
  100% {
    visibility: hidden;
  }
}
@keyframes box-move {
  0% {
    background-position: tovmin(0) tovmin(0);
  }
  1.54% {
    background-position: tovmin(-421) tovmin(0);
  }
  3.08% {
    background-position: tovmin(-842) tovmin(0);
  }
  4.62% {
    background-position: tovmin(-1263) tovmin(0);
  }
  6.15% {
    background-position: tovmin(0) tovmin(-338);
  }
  7.69% {
    background-position: tovmin(-421) tovmin(-338);
  }
  9.23% {
    background-position: -842tovmin (-842) tovmin(-338);
  }
  10.77% {
    background-position: tovmin(-1263) tovmin(-338);
  }
  12.31% {
    background-position: tovmin(0) tovmin(-676);
  }
  13.85% {
    background-position: tovmin(-421) tovmin(-676);
  }
  15.38% {
    background-position: tovmin(-842) tovmin(-676);
  }
  16.92% {
    background-position: tovmin(-1263) tovmin(-676);
  }
  18.46% {
    background-position: 0tovmin (0) tovmin(-1014);
  }
  20.00% {
    background-position: tovmin(-421) tovmin(-1014);
  }
  21.54% {
    background-position: tovmin(-842) tovmin(-1014);
  }
  23.08% {
    background-position: tovmin(-1263) tovmin(-1014);
  }
  24.62% {
    background-position: tovmin(0) tovmin(-1352);
  }
  26.15% {
    background-position: -421tovmin () tovmin(-1352);
  }
  27.69% {
    background-position: -842tovmin () tovmin(-1352);
  }
  29.23% {
    background-position: -1263tovmin () tovmin(-1352);
  }
  30.77% {
    background-position: tovmin(0) tovmin(-1690);
  }
  32.31% {
    background-position: tovmin(-421) tovmin(-1690);
  }
  33.85% {
    background-position: tovmin(-842) tovmin(-1690);
  }
  35.38% {
    background-position: tovmin(-1263) tovmin(-1690);
  }
  36.92% {
    background-position: tovmin(0) tovmin(-2028);
  }
  38.46% {
    background-position: tovmin(-421) tovmin(-2028);
  }
  40.00% {
    background-position: tovmin(-842) tovmin(-2028);
  }
  41.54% {
    background-position: tovmin(-1263) tovmin(-2028);
  }
  43.08% {
    background-position: tovmin(0) tovmin(-2366);
  }
  44.62% {
    background-position: tovmin(-421) tovmin(-2366);
  }
  46.15% {
    background-position: tovmin(-842) tovmin(-2366);
  }
  47.69% {
    background-position: tovmin(-1263) tovmin(-2366);
  }
  49.23% {
    background-position: tovmin(0) tovmin(-2704);
  }
  50.77% {
    background-position: tovmin(-421) tovmin(-2704);
  }
  52.31% {
    background-position: tovmin(-842) tovmin(-2704);
  }
  53.85% {
    background-position: tovmin(-1263) tovmin(-2704);
  }
  55.38% {
    background-position: tovmin(0) tovmin(-3042);
  }
  56.92% {
    background-position: tovmin(-421) tovmin(-3042);
  }
  58.46% {
    background-position: tovmin(-842) tovmin(-3042);
  }
  60.00% {
    background-position: tovmin(-1263) tovmin(-3042);
  }
  61.54% {
    background-position: tovmin(0) tovmin(-3380);
  }
  63.08% {
    background-position: tovmin(-421) tovmin(-3380);
  }
  64.62% {
    background-position: tovmin(-842) tovmin(-3380);
  }
  66.15% {
    background-position: tovmin(-1263) tovmin(-3380);
  }
  67.69% {
    background-position: tovmin(0) tovmin(-3718);
  }
  69.23% {
    background-position: tovmin(-421) tovmin(-3718);
  }
  70.77% {
    background-position: tovmin(-842) tovmin(-3718);
  }
  72.31% {
    background-position: tovmin(-1263) tovmin(-3718);
  }
  73.85% {
    background-position: tovmin(0) tovmin(-4056);
  }
  75.38% {
    background-position: tovmin(-421) tovmin(-4056);
  }
  76.92% {
    background-position: tovmin(-842) tovmin(-4056);
  }
  78.46% {
    background-position: tovmin(-1263) tovmin(-4056);
  }
  80.00% {
    background-position: tovmin(0) tovmin(-4394);
  }
  81.54% {
    background-position: tovmin(-421) tovmin(-4394);
  }
  83.08% {
    background-position: tovmin(-842) tovmin(-4394);
  }
  84.62% {
    background-position: tovmin(-1263) tovmin(-4394);
  }
  86.15% {
    background-position: tovmin(0) tovmin(-4732);
  }
  87.69% {
    background-position: tovmin(-421) tovmin(-4732);
  }
  89.23% {
    background-position: tovmin(-842) tovmin(-4732);
  }
  90.77% {
    background-position: tovmin(-1263) tovmin(-4732);
  }
  92.31% {
    background-position: tovmin(0) tovmin(-5070);
  }
  93.85% {
    background-position: tovmin(-421) tovmin(-5070);
  }
  95.38% {
    background-position: tovmin(-842) tovmin(-5070);
  }
  96.92% {
    background-position: tovmin(-1263) tovmin(-5070);
  }
  98.46% {
    background-position: tovmin(0) tovmin(-5408);
  }
  100.00% {
    background-position: tovmin(-421) tovmin(-5408);
  }
}
@keyframes card-star {
  0% {
    background-position: tovmin(0) tovmin(0);
  }
  3.85% {
    background-position: tovmin(-661) tovmin(0);
  }
  7.69% {
    background-position: tovmin(-1322) tovmin(0);
  }
  11.54% {
    background-position: tovmin(0) tovmin(-480);
  }
  15.38% {
    background-position: tovmin(-661) tovmin(-480);
  }
  19.23% {
    background-position: tovmin(-1322) tovmin(-480);
  }
  23.08% {
    background-position: tovmin(0) tovmin(-960);
  }
  26.92% {
    background-position: tovmin(-661) tovmin(-960);
  }
  30.77% {
    background-position: tovmin(-1322) tovmin(-960);
  }
  34.62% {
    background-position: tovmin(0) tovmin(-1440);
  }
  38.46% {
    background-position: tovmin(-661) tovmin(-1440);
  }
  42.31% {
    background-position: tovmin(-1322) tovmin(-1440);
  }
  46.15% {
    background-position: tovmin(0) tovmin(-1920);
  }
  50.00% {
    background-position: tovmin(-661) tovmin(-1920);
  }
  53.85% {
    background-position: tovmin(-1322) tovmin(-1920);
  }
  57.69% {
    background-position: tovmin(0) tovmin(-2400);
  }
  61.54% {
    background-position: tovmin(-661) tovmin(-2400);
  }
  65.38% {
    background-position: tovmin(-1322) tovmin(-2400);
  }
  69.23% {
    background-position: tovmin(0) tovmin(-2880);
  }
  73.08% {
    background-position: tovmin(-661) tovmin(-2880);
  }
  76.92% {
    background-position: tovmin(-1322) tovmin(-2880);
  }
  80.77% {
    background-position: tovmin(0) tovmin(-3360);
  }
  84.62% {
    background-position: tovmin(-661) tovmin(-3360);
  }
  88.46% {
    background-position: tovmin(-1322) tovmin(-3360);
  }
  92.31% {
    background-position: tovmin(0) tovmin(-3840);
  }
  96.15% {
    background-position: tovmin(-661) tovmin(-3840);
  }
  100.00% {
    background-position: tovmin(-1322) tovmin(-3840);
  }
}
@keyframes show-cover {
  0% {
    visibility: visible;
  }
  98% {
    visibility: visible;
  }
  100% {
    visibility: hidden;
  }
}
@keyframes right-rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
@keyframes gather-guide-animation {
  0% {
    opacity: 0;
    margin-left: tovmin(100);
  }
  100% {
    opacity: 1;
    margin-left: 0;
  }
}
@keyframes gather-bar-animation {
  0% {
    visibility: visible;
    transform: scale(0.1, 0.1);
  }
  100% {
    visibility: visible;

    transform: scale(1, 1);
  }
}
@keyframes gather-yaya-animation {
  0% {
    margin-right: tovmin(200);
  }
  100% {
    margin-left: tovmin(83);
  }
}
@keyframes gather-yaya-flag {
  0% {
    background-position: tovmin(0) tovmin(0);
  }
  5.26% {
    background-position: tovmin(-280) tovmin(0);
  }
  10.53% {
    background-position: tovmin(-560) tovmin(0);
  }
  15.79% {
    background-position: tovmin(-840) tovmin(0);
  }
  21.05% {
    background-position: tovmin(-1120) tovmin(0);
  }
  26.32% {
    background-position: tovmin(-1400) tovmin(0);
  }
  31.58% {
    background-position: tovmin(-1680) tovmin(0);
  }
  36.84% {
    background-position: tovmin(0) tovmin(-360);
  }
  42.11% {
    background-position: tovmin(-280) tovmin(-360);
  }
  47.37% {
    background-position: tovmin(-560) tovmin(-360);
  }
  52.63% {
    background-position: tovmin(-840) tovmin(-360);
  }
  57.89% {
    background-position: tovmin(-1120) tovmin(-360);
  }
  63.16% {
    background-position: tovmin(-1400) tovmin(-360);
  }
  68.42% {
    background-position: tovmin(-1680) tovmin(-360);
  }
  73.68% {
    background-position: tovmin(0) tovmin(-720);
  }
  78.95% {
    background-position: tovmin(-280) tovmin(-720);
  }
  84.21% {
    background-position: tovmin(-560) tovmin(-720);
  }
  89.47% {
    background-position: tovmin(-840) tovmin(-720);
  }
  94.74% {
    background-position: tovmin(-1120) tovmin(-720);
  }
  100.00% {
    background-position: tovmin(-1400) tovmin(-720);
  }
}
</style>
