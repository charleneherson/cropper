window.clientList = window.clientList ? window.clientList : {};
var listen
var trigger
var remove
// 监听
listen = function (key: string, fn: Function) {
  console.log(`listen:${key}`)
  if (!window.clientList[key]) {
    window.clientList[key] = []
  }
  window.clientList[key].push(fn)
  console.log(window.clientList)
}
// 触发
trigger = function (event?: any, data?: any) {
  console.log(window.clientList)
  var key = Array.prototype.shift.call(arguments)
  var fns = window.clientList[key]
  console.log(`trigger:${key}`)
  console.log(fns)
  if (!fns || fns.length === 0) {
    return false
  }

  for (var i = 0, fn; (fn = fns[i++]);) {
    fn.apply(this, arguments)
  }
}
// 移除
remove = function (key: string, fn: Function) {
  console.log(`remove:${key}`)
  var fns = window.clientList[key]
  if (!fns) {
    return false
  }
  if (!fn) {
    // fns && (fns.length = 0);
  } else {
    for (var len = fns.length - 1; len >= 0; len--) {
      var _fn = fns[len]
      if (_fn === fn) {
        fns.splice(len, 1)
      }
    }
  }
}

export default {
  listen,
  trigger,
  remove
}
