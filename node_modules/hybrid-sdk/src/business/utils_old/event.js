var clientList = {}
var listen
var trigger
var remove
// 监听
listen = function (key, fn) {
  console.log(`listen:${key}`)
  if (!clientList[key]) {
    clientList[key] = []
  }
  clientList[key].push(fn)
  console.log(clientList)
}
// 触发
trigger = function () {
  console.log(clientList)
  var key = Array.prototype.shift.call(arguments)
  var fns = clientList[key]
  console.log(`trigger:${key}`)
  console.log(fns)
  if (!fns || fns.length === 0) {
    return false
  }

  for (var i = 0, fn; (fn = fns[i++]);) {
    fn.apply(this, arguments)
  }
}
// 移除
remove = function (key, fn) {
  console.log(`remove:${key}`)
  var fns = clientList[key]
  if (!fns) {
    return false
  }
  if (!fn) {
    // fns && (fns.length = 0);
  } else {
    for (var len = fns.length - 1; len >= 0; len--) {
      var _fn = fns[len]
      if (_fn === fn) {
        fns.splice(len, 1)
      }
    }
  }
}

export default {
  listen,
  trigger,
  remove
}
