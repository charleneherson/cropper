import { hybrid, createHybridCallback } from '../../../utils/iframeHybrid'

/*
 *http://qatest7.suanshubang.com/static/fe-docs/_book/hybrid-sdk/app_window.html
 */

/**
 * Copyright (c) 2014-2018 Zuoyebang, All rights reserved.
 * @fileoverview 页面跳转
 * @author liujianwei | liujianwei@zybang.com
 * @version 1.0 |2018-9-28 | liujianwei    // 初始版本。
 * @method gotoPage(options)    // 方法：App hybrid 调用.
 *   @param options.action {String}          // 参数：Hybrid 调用的 action 名(必填)。
 *   @param options.data {Object}            // 参数：调用的参数(可选，默认为空)。
 *   @param callback {Function}              // 参数：回调(可选，默认无)。
 *   @return No                              // 返回：无。
 */
export function gotoPage (options: any) {
  var { action, data } = options
  hybrid(action, data)
}

/**
 * 端内跳转通用接口
 * @param {Object} options
 *    @property data          {Object}    //跳转的地址,{url:''}
 *    @property success       {Function}  //成功回调
 *    @property error         {Function}  //失败回调
 */
export function navigate (options: any) {
  var { data, success, notFound } = options
  if (!data || !data.url) {
    console.error('navigate api data.url is  undefined')
    return
  }
  var callback = createHybridCallback(success, notFound)
  hybrid('openAppRuoterPage', data, callback)
}
/**
 * @description: 跳转小程序
 * @param {Object}
 *    @property appId         {string}    //作业帮:wxa5677f1877d37b12 一课:wx7d02bbfdc96bf728(可选,可以不传,端上做了兼容处理)
 *    @property userName      {string}    //填小程序原始id
 *    @property path          {string}    //跳转路径,拉起小程序页面的可带参路径，不填默认拉起小程序首页
 *    @property type          {number}    //小程序类型 0:正式，1:开发，2:体验。默认0
 *
 */
export function openWxApp (options: any) {
  var { data, success, notFound } = options
  if (!data || !data.userName || !data.path) {
    console.error('openWxApp api data.userName or data.path is undefined')
    return
  }
  if (!data.type) {
    data.type = 0
  }
  var callback = createHybridCallback(success, notFound)
  hybrid('liveOpenWxApplet', data, callback)
}
