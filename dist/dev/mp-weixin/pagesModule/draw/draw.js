(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["pagesModule/draw/draw"],{

/***/ 43:
/*!**********************************************************!*\
  !*** ./src/main.js?{"page":"pagesModule%2Fdraw%2Fdraw"} ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(createPage) {

__webpack_require__(/*! uni-pages */ 4);

__webpack_require__(/*! @dcloudio/uni-stat */ 5);

var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 2));

var _draw = _interopRequireDefault(__webpack_require__(/*! ./pagesModule/draw/draw.vue */ 44));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

createPage(_draw.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["createPage"]))

/***/ }),

/***/ 44:
/*!***************************************!*\
  !*** ./src/pagesModule/draw/draw.vue ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _draw_vue_vue_type_template_id_35e00127___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./draw.vue?vue&type=template&id=35e00127& */ 45);
/* harmony import */ var _draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./draw.vue?vue&type=script&lang=js& */ 47);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./draw.vue?vue&type=style&index=0&lang=scss& */ 51);
/* harmony import */ var _node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js */ 23);






/* normalize component */

var component = Object(_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _draw_vue_vue_type_template_id_35e00127___WEBPACK_IMPORTED_MODULE_0__["render"],
  _draw_vue_vue_type_template_id_35e00127___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  null,
  null
  
)

/* hot reload */
if (false) { var api; }
component.options.__file = "src/pagesModule/draw/draw.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 45:
/*!**********************************************************************!*\
  !*** ./src/pagesModule/draw/draw.vue?vue&type=template&id=35e00127& ***!
  \**********************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_template_id_35e00127___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/vue-loader/lib??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./draw.vue?vue&type=template&id=35e00127& */ 46);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_template_id_35e00127___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_template_id_35e00127___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });



/***/ }),

/***/ 46:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/pagesModule/draw/draw.vue?vue&type=template&id=35e00127& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
var render = function() {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
}
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 47:
/*!****************************************************************!*\
  !*** ./src/pagesModule/draw/draw.vue?vue&type=script&lang=js& ***!
  \****************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/babel-loader/lib!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/vue-loader/lib??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./draw.vue?vue&type=script&lang=js& */ 48);
/* harmony import */ var _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 48:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/pagesModule/draw/draw.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var ComHeader = function ComHeader() {
  return __webpack_require__.e(/*! import() | pagesModule/draw/components/com-header */ "pagesModule/draw/components/com-header").then(__webpack_require__.bind(null, /*! ./components/com-header.vue */ 59));
};

// import store from "./store";
var _default = {
  data: function data() {
    return {
      context: null,
      elements: [],
      avatar: {
        x: 0,
        y: 0,
        type: "avatar",
        width: 300,
        height: 300,
        path: "./static/images/avatar/1.png",
        trans: 0,
        zIndex: 0
      },
      photo: {
        x: 0,
        y: 0,
        type: "photo",
        width: 300,
        height: 300,
        path: "./static/images/images/photo/1.png",
        trans: 0,
        zIndex: 0
      },
      icon: {
        id: 0,
        type: "icon",
        x: 100,
        y: 100,
        width: 100,
        height: 100,
        path: "",
        trans: 0,
        zIndex: 0,
        scale: 1,
        translateX: 0,
        translateY: 0,
        rotate: 0,
        active: true
      },
      text: {
        type: "text",
        content: "content",
        width: "",
        height: "",
        fontsize: "",
        color: "",
        zIndex: ""
      },
      touch: {
        delete: -1,
        method: "",
        element: {
          index: 0,
          width: 0,
          height: 0,
          x: 0,
          y: 0,
          rotate: 0,
          scale: 1
        },
        start: {
          index: 0,
          x: 0,
          y: 0
        },
        move: {
          x: 0,
          y: 0
        }
      },
      avatarList: [// {
        //   path: "./static/images/avatar/1.png",
        //   isAuth: true
        // },
        // {
        //   path: "./../../static/images/avatar/2.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/3.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/4.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/5.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/6.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/7.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/8.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/9.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/10.jpg"
        // },
        // {
        //   path: "./../../static/images/avatar/11.jpg"
        // }
      ],
      photoList: [// {
        //   path: "./../../static/images/photo/1.png"
        // },
        // {
        //   path: "./../../static/images/photo/2.png"
        // },
        // {
        //   path: "./../../static/images/photo/3.png"
        // },
        // {
        //   path: "./../../static/images/photo/4.png"
        // },
        // {
        //   path: "./../../static/images/photo/5.png"
        // },
        // {
        //   path: "./../../static/images/photo/6.png"
        // },
        // {
        //   path: "./../../static/images/photo/7.png"
        // },
        // {
        //   path: "./../../static/images/photo/8.png"
        // },
        // {
        //   path: "./../../static/images/photo/9.png"
        // },
        // {
        //   path: "./../../static/images/photo/10.png"
        // }
      ],
      iconList: [],
      list: null,
      active: "icon",
      timer: 0,
      selectId: 0
    };
  },
  computed: {// list() {
    //   return store.getters.list;
    // }
  },
  components: {
    ComHeader: ComHeader
  },
  onShareAppMessage: function onShareAppMessage(res) {
    return {
      title: "情头贴纸",
      path: "/pages/index/main",
      success: function success(res) {// 转发成功
      },
      fail: function fail(res) {// 转发失败
      }
    };
  },
  methods: {
    getuserinfo: function getuserinfo(e) {
      return;

      var _this = this;

      wx.downloadFile({
        url: e.mp.detail.userInfo.avatarUrl,
        success: function success(res) {
          _this.avatarList[0].path = res.tempFilePath;
          _this.avatarList[0].isAuth = false;
          _this.avatar.path = _this.avatarList[0].path;

          _this.drawimage();
        }
      });
    },
    reset: function reset() {
      // 初始化
      var _this = this;

      wx.showActionSheet({
        itemList: ["选择照片", "选择头像"],
        success: function success(res) {
          console.log(res.tapIndex);

          if (res.tapIndex === 0) {
            wx.navigateTo({
              url: "/pages/cropper/main"
            });
          } else if (res.tapIndex === 1) {
            _this.getInfo();
          }
        },
        fail: function fail(res) {
          console.log(res.errMsg);
        }
      });
    },
    drawimage: function drawimage() {
      // 头像
      console.log("drawimage drawimage drawimage drawimage"); // if (this.avatar.path) {
      //   this.context.drawImage(
      //     this.avatar.path,
      //     this.avatar.x,
      //     this.avatar.y,
      //     this.avatar.width,
      //     this.avatar.height
      //   );
      // }
      // // 挂件
      // for (let item of this.elements) {
      //   if (item.type === "icon") {
      //     this.context.save();
      //     this.context.translate(
      //       item.translateX,
      //       item.translateY
      //     );
      //     this.context.rotate(
      //       (item.rotate * Math.PI) / 180
      //     );
      //     this.context.translate(
      //       -item.translateX,
      //       -item.translateY
      //     );
      //     this.context.drawImage(
      //       item.path,
      //       item.x,
      //       item.y,
      //       item.width,
      //       item.height
      //     );
      //     // 如果挂件已激活
      //     if (item.active) {
      //       this.context.setLineDash([5, 10], 10);
      //       this.context.setStrokeStyle("#fb5534");
      //       this.context.setLineCap("round");
      //       this.context.setLineJoin("round");
      //       this.context.setLineWidth(2);
      //       this.context.strokeRect(
      //         item.x - 1,
      //         item.y - 1,
      //         item.width + 2,
      //         item.height + 2
      //       );
      //       this.context.drawImage(
      //         "./../../static/images/icon/clear.png",
      //         item.x - 14,
      //         item.y - 14,
      //         28,
      //         28
      //       );
      //       this.context.drawImage(
      //         "./../../static/images/icon/drag.png",
      //         item.x + item.width - 14,
      //         item.y + item.height - 14,
      //         28,
      //         28
      //       );
      //     }
      //     this.context.restore();
      //   } else if (item.type === "text") {
      //     console.log("text");
      //   }
      // }
      // // 相框
      // if (this.photo.path) {
      //   this.context.drawImage(
      //     this.photo.path,
      //     this.photo.x,
      //     this.photo.y,
      //     this.photo.width,
      //     this.photo.height
      //   );
      // }

      var p = "/../../../static/images/icon/clear.png";
      this.context.drawImage(p, 0 + 100 - 14, 0 + 100 - 14, 100, 100);
      this.context.setStrokeStyle('blue');
      this.context.strokeRect(10, 10, 200, 200);
      this.context.draw();
    },
    touchstart: function touchstart(e) {
      // 判断是偏移, 旋转还是放大
      console.log("touchstart"); // 触摸的开始值

      this.touch.start.x = e.touches[0].x;
      this.touch.start.y = e.touches[0].y; // 初始化触摸的元素

      this.touch.method = "";
      this.touch.element.index = -1;
      this.touch.element.width = 0;
      this.touch.element.height = 0;
      this.touch.element.x = 0;
      this.touch.element.y = 0;
      this.touch.element.scale = 1;
      this.touch.element.rotate = 0; // for (let [i, item] of new Map(this.elements.map((item, i) => [i, item]))) {

      for (var i = this.elements.length - 1; i !== -1; i--) {
        var item = this.elements[i]; // 计算物体旋转之后的位置

        var r = Math.sqrt(2) * (item.width / 2);
        var center = {
          x: 0,
          y: 0
        };
        var del = {
          x: 0,
          y: 0
        };
        var move = {
          x: 0,
          y: 0
        };
        center.x = item.x + item.width / 2;
        center.y = item.y + item.height / 2;
        del.x = center.x + r * Math.sin(Math.PI / 180 * (-45 - item.rotate));
        del.y = center.y - r * Math.cos(Math.PI / 180 * (-45 - item.rotate));
        move.y = center.y + r * Math.sin(Math.PI / 180 * (135 - item.rotate));
        move.x = center.x - r * Math.cos(Math.PI / 180 * (135 - item.rotate));

        if (item && item.active) {
          // 判断删除
          if (e.touches[0].x > del.x - 16 && e.touches[0].x < del.x + 16 && e.touches[0].y > del.y - 16 && e.touches[0].y < del.y + 16) {
            this.touch.method = "clear";
            this.touch.delete = i;
            break;
          } // 判断旋转放大


          if (e.touches[0].x > move.x - 16 && e.touches[0].x < move.x + 16 && e.touches[0].y > move.y - 16 && e.touches[0].y < move.y + 16) {
            console.log("旋转放大");
            this.touch.method = "scale";
            this.touch.element.index = i;
            this.touch.element.width = item.width;
            this.touch.element.height = item.height;
            this.touch.element.x = item.x;
            this.touch.element.y = item.y;
            this.touch.element.scale = item.scale;
            this.touch.element.rotate = item.rotate;
            break;
          }
        }

        if (e.touches[0].x > center.x - r && e.touches[0].x < center.x + r && e.touches[0].y > center.y - r && e.touches[0].y < center.y + r) {
          console.log("拖动");
          this.touch.method = "drag";
          this.touch.element.index = i;
          this.touch.element.width = item.width;
          this.touch.element.height = item.height;
          this.touch.element.x = item.x;
          this.touch.element.y = item.y;
          this.touch.element.scaleX = item.scaleX;
          this.touch.element.scaleY = item.scaleY;
          this.touch.element.rotate = item.rotate;
          break;
        }
      } // 执行删除命令


      if (this.touch.method === "clear" && this.touch.delete !== -1) {
        this.elements.splice(this.touch.delete, 1);
        this.touch.delete = -1;
      }

      var _iteratorNormalCompletion = true;
      var _didIteratorError = false;
      var _iteratorError = undefined;

      try {
        for (var _iterator = this.elements[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
          var _item = _step.value;
          _item.active = false;
        }
      } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion && _iterator.return != null) {
            _iterator.return();
          }
        } finally {
          if (_didIteratorError) {
            throw _iteratorError;
          }
        }
      }

      if (this.touch.element.index !== -1 && this.touch.element.index < this.elements.length) {
        this.elements[this.touch.element.index].active = true;
      }

      console.log("drawimage");
      this.drawimage();
    },
    touchmove: function touchmove(e) {
      if (this.touch.element.index === -1) {
        return;
      }

      if (this.touch.method === "drag") {
        if (e.touches[0].x > 0 && e.touches[0].x < 300 && e.touches[0].y > 0 && e.touches[0].y < 300) {
          this.touch.move.x = e.touches[0].x;
          this.touch.move.y = e.touches[0].y;
          this.elements[this.touch.element.index].x = this.touch.element.x + this.touch.move.x - this.touch.start.x;
          this.elements[this.touch.element.index].y = this.touch.element.y + this.touch.move.y - this.touch.start.y;
        }
      } else if (this.touch.method === "scale") {
        // 旋转放大中
        this.touch.move.x = e.touches[0].x;
        this.touch.move.y = e.touches[0].y; // 放大

        this.elements[this.touch.element.index].x = this.touch.element.x - this.touch.move.x + this.touch.start.x;
        this.elements[this.touch.element.index].y = this.touch.element.y - this.touch.move.x + this.touch.start.x;
        this.elements[this.touch.element.index].width = (this.touch.move.x - this.touch.start.x) * 2 + this.touch.element.width;
        this.elements[this.touch.element.index].height = (this.touch.move.x - this.touch.start.x) * 2 + this.touch.element.height; // 中心点的坐标

        var centerX = this.touch.element.x + this.touch.element.width / 2;
        var centerY = this.touch.element.y + this.touch.element.height / 2; // 设置原点

        this.elements[this.touch.element.index].translateX = centerX;
        this.elements[this.touch.element.index].translateY = centerY; // 触摸前的角度

        var diffXBefore = this.touch.start.x - centerX;
        var diffYBefore = this.touch.start.y - centerY;
        var diffXAfter = this.touch.move.x - centerX;
        var diffYAfter = this.touch.move.y - centerY;
        var angleBefore = Math.atan2(diffYBefore, diffXBefore) / Math.PI * 180;
        var angleAfter = Math.atan2(diffYAfter, diffXAfter) / Math.PI * 180; // this.elements[0].scale = distanceAfter / distanceBefore * this.touch.element.scale

        this.elements[this.touch.element.index].rotate = angleAfter - angleBefore + this.touch.element.rotate;
        console.log(this.elements[this.touch.element.index].rotate); // 触摸后的角度
      }

      this.drawimage();
    },
    touchend: function touchend(e) {
      if (this.touch.method === "drag") {
        console.log("drag");
      } else if (this.touch.method === "clear") {
        console.log("clear");
      } else if (this.touch.method === "scale") {
        console.log("scale");
      }
    },
    touchcancel: function touchcancel(e) {
      console.log("touchcancel");
    },
    delete: function _delete() {
      console.log("delete");

      if (this.touch.method === "clear" && this.touch.delete !== -1) {
        this.elements.splice(this.touch.delete, 1);
        this.touch.delete = -1;
      }

      this.drawimage();
    },
    add: function add() {
      console.log("add");
    },
    select: function select(e) {
      console.log(e);
      this.active = e;

      if (this.active === "avatar") {
        this.list = this.avatarList;
      } else if (this.active === "photo") {
        this.list = this.photoList;
      } else if (this.active === "icon") {
        this.list = this.iconList;
      } else if (this.active === "text") {
        this.list = this.textList;
      }
    },
    select2: function select2(e) {
      var _this = this;

      console.log(e);
      var icon = JSON.parse(JSON.stringify(this.icon));

      if (this.active === "avatar") {
        this.avatar.path = this.avatarList[e].path;

        _this.drawimage();
      } else if (this.active === "photo") {
        this.photo.path = this.photoList[e].path;

        _this.drawimage();
      } else if (this.active === "icon") {
        wx.downloadFile({
          url: _this.iconList[e].path,
          success: function success(r) {
            icon.path = r.tempFilePath;
            icon.id = _this.timer;
            icon.active = true;
            _this.timer++;

            _this.elements.push(icon);

            _this.drawimage();
          }
        });
      } else if (this.active === "text") {
        wx.downloadFile({
          url: _this.textList[e].path,
          success: function success(r) {
            icon.path = r.tempFilePath;
            icon.id = _this.timer;
            icon.active = true;
            _this.timer++;

            _this.elements.push(icon);

            _this.drawimage();
          }
        });
      }
    },
    next: function next() {
      wx.showLoading({
        title: "制作中"
      });
      var _iteratorNormalCompletion2 = true;
      var _didIteratorError2 = false;
      var _iteratorError2 = undefined;

      try {
        for (var _iterator2 = this.elements[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
          var item = _step2.value;
          item.active = false;
        }
      } catch (err) {
        _didIteratorError2 = true;
        _iteratorError2 = err;
      } finally {
        try {
          if (!_iteratorNormalCompletion2 && _iterator2.return != null) {
            _iterator2.return();
          }
        } finally {
          if (_didIteratorError2) {
            throw _iteratorError2;
          }
        }
      }

      this.drawimage();
      setTimeout(function () {
        wx.canvasToTempFilePath({
          x: 0,
          y: 0,
          width: 300,
          height: 300,
          destWidth: 600,
          destHeight: 600,
          canvasId: "firstCanvas",
          success: function success(res) {
            console.log(res.tempFilePath);
            wx.hideLoading();
            wx.navigateTo({
              url: "/pages/share/main?path=" + res.tempFilePath
            });
          }
        });
      }, 100);
    },
    getInfo: function getInfo() {
      var _this = this;

      wx.getSetting({
        success: function success(response) {
          if (response.authSetting["scope.userInfo"]) {
            wx.getUserInfo({
              success: function success(res) {
                console.log(res);
                wx.downloadFile({
                  url: res.userInfo.avatarUrl,
                  success: function success(r) {
                    _this.avatarList[0].path = r.tempFilePath;
                    _this.avatar.path = _this.avatarList[0].path;
                    _this.avatarList[0].isAuth = false;

                    _this.drawimage();
                  }
                });
              }
            });
          } else {
            _this.drawimage();
          }
        }
      });
    },
    init: function init() {
      var arr = [{
        path: "https://csdnimg.cn/cdn/content-toolbar/csdnlogo.png"
      }, {
        path: "https://csdnimg.cn/cdn/content-toolbar/csdnlogo.png"
      }]; // for (let i = 1; i <= 30; i++) {
      //   let path = i > 9 ? 'https://image.cloudbooks.cc/image/icon/00' + i + '.png' : 'https://image.cloudbooks.cc/image/icon/000' + i + '.png'
      //   let item = {
      //     path: path
      //   }
      //   arr.push(item)
      // }

      this.iconList = arr;
      console.log("this.iconList", this.iconList);
      var textArr = [[{
        path: "https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/steps/bg_submerge_1.png"
      }, {
        path: "https://zyb-yayayuwen-1253445850.cos.ap-beijing.myqcloud.com/yaya-fe/steps/bg_submerge_2.png"
      }]]; // for (let i = 1; i <= 26; i++) {
      //   let path = i > 9 ? 'https://image.cloudbooks.cc/image/text/00' + i + '.png' : 'https://image.cloudbooks.cc/image/text/000' + i + '.png'
      //   let item = {
      //     path: path
      //   }
      //   textArr.push(item)
      // }
      // this.textList = textArr;
    }
  },
  mounted: function mounted() {
    // 初始化贴纸数组
    this.init();
    this.context = wx.createCanvasContext("firstCanvas");

    if (this.active === "avatar") {
      this.list = this.avatarList;
    } else if (this.active === "photo") {
      this.list = this.photoList;
    } else if (this.active === "icon") {
      this.list = this.iconList;
    } else if (this.active === "text") {
      this.list = this.textList;
    }

    this.drawimage(); // this.context.setFillStyle('blue')

    this.context.setStrokeStyle('blue');
    this.context.strokeRect(10, 10, 150, 75);
    wx.showLoading();
    setTimeout(function () {
      wx.canvasToTempFilePath({
        x: 0,
        y: 0,
        width: 100,
        height: 100,
        destWidth: 300,
        destHeight: 400,
        canvasId: "firstCanvas",
        success: function success(res) {
          console.log("canvasToTempFilePath suc ", res.tempFilePath);
          wx.hideLoading(); // wx.navigateTo({
          //   url:
          //     "/pages/share/main?path=" + res.tempFilePath
          // });
        }
      });
    }, 100); // if (this.$mp.query.path) {
    //   console.log(this.$mp.query.path)
    //   // this.avatarList[0].path = this.$mp.query.path
    //   // this.avatar.path = this.avatarList[0].path
    // } else {
    //   // this.getInfo()
    // }
  }
};
exports.default = _default;

/***/ }),

/***/ 51:
/*!*************************************************************************!*\
  !*** ./src/pagesModule/draw/draw.vue?vue&type=style&index=0&lang=scss& ***!
  \*************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-1!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-2!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src??ref--8-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!../../../node_modules/vue-loader/lib??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./draw.vue?vue&type=style&index=0&lang=scss& */ 52);
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_1_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_2_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_node_modules_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_custom_block_loader_index_js_ref_0_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_draw_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 52:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-1!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-2!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader??ref--0-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/pagesModule/draw/draw.vue?vue&type=style&index=0&lang=scss& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[43,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pagesModule/draw/draw.js.map